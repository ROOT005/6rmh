<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1 ,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
	<title><{$config.page_title}></title>
	<link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
	<link href="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="__STATIC__/css/plugin/mall_mobile_footer.css">
	<link rel="stylesheet" type="text/css" href="__STATIC__/css/plugin/mall_balance.css">
	<script src="http://cdn.static.runoob.com/libs/jquery/2.1.1/jquery.min.js"></script>
	<script type="text/javascript" src="__STATIC__/layui/layui.all.js" ></script>
</head>
<body>
	<div class="head">
		<div class="head-title"><!-- <span class="back_home fa fa-long-arrow-left fa-1x"></span> -->收货地址</div>
	</div>
	<div class="body">
		<div class="address title">　您已创建<span class="fone-color"><{$count}></span>个收货地址，最多可创建<span class="fone-color">10</span>个</div>
	<{volist name="address" id="vo"}>
		<div class="withdraw row">
			<div class="col-xs-4 address right">收货人：</div>
			<div class="col-xs-8 address left"><{$vo.name}></div>
			<div class="col-xs-4 address right">所在地区</div>
			<div class="col-xs-8 address left"><{$vo.addr}></div>
			<div class="col-xs-4 address right">地址：</div>
			<div class="col-xs-8 address left"><{$vo.address}></div>
			<div class="col-xs-4 address right">手机：</div>
			<div class="col-xs-8 address left"><{$vo.mobile}></div>
			<div class="col-xs-4 address right">邮编：</div>
			<div class="col-xs-8 address left"><{$vo.zipcode}></div>
			<div class="col-xs-6 center"><input type="radio" name="checked" value=""><a href="">设为默认</a></div>
			<div class="col-xs-3 center"><a href="<{:url('edit',['id' => $vo['id']])}>">编辑</a></div>
			<div class="col-xs-3 center"><a href="<{:url('del',['id' => $vo['id']])}>">删除</a></div>
		</div>
	<{/volist}>
	<div class="addd" style="display: none">
		<form  class="layui-form" method="post" name="form" id="myform" action="<{:url('add')}>">
			<span class="address-add">
				<div class="layui-form-item">
				  <label class="layui-form-label">收货人：</label>
				  <div class="layui-input-block">
				    <input type="text" name="name" required  lay-verify="required" placeholder="请输入姓名" autocomplete="off" class="layui-input">
				  </div>
				</div>
				<div class="layui-form-item">
				  <label class="layui-form-label">所在地区：</label>
				  <div class="layui-input-block">
				    <select class="pro kshow" id="province" name="province" lay-verify="required">
				      <option value=""  selected>==选择==</option>
				      <{volist name="province" id="vo"}>
					   <option value="<{$vo.id}>"><{$vo.name}></option>
					   <{/volist}>
				    </select>
				    <select id="city" name="city" class="khidden"></select>
				    <select id="area" name="area" class="khidden"> </select>
				  </div>
				</div>
				<div class="layui-form-item">
				  <label class="layui-form-label">地址：</label>
				  <div class="layui-input-block">
				    <input type="text" name="address" required  placeholder="请输入地址" autocomplete="off" class="layui-input">
				  </div>
				</div>
				<div class="layui-form-item">
				  <label class="layui-form-label">手机：</label>
				  <div class="layui-input-block">
				    <input type="text" name="mobile" required  lay-verify="required" placeholder="请输入电话" autocomplete="off" class="layui-input">
				  </div>
				</div>
				<div class="layui-form-item">
				  <label class="layui-form-label">邮编：</label>
				  <div class="layui-input-block">
				    <input type="text" name="zipcode" required  lay-verify="required" autocomplete="off" class="layui-input">
				  </div>
				</div>
			</span>
		</form>
	</div>
	<span class="add fa  fa-plus"></span>

	<script type="text/javascript">

	    var addd = $('.addd').html();
	    //alert(addd);
		$('.add').click(function(){
			
			layer.open({
			    title: [
			      '添加地址',
			      'background-color: #6ad4c9; color:#fff;'
			    ]
			    ,content:addd,
			    btn: ['确认', '取消'],
			    yes: function(index){
			    	console.log($('input[name="name"]').val());
			    	console.log($('input[name="city"]').val());
			    	console.log($('input[name="mobile"]').val());
			    	console.log($('input[name="address"]').val());
			    	if($('input[name="name"]').val()==''||$('input[name="city"]').val()==''||$('input[name="mobile"]').val()==''||$('input[name="address"]').val()==''){
			    			alert('必填信息不得为空');
			    	}else{
			      	$('#myform').submit(); }
			    }   
			     });
			$(document).ready(function(){
			    //选择省份
			    $('select[name=province]').change(function(){
			        
			        $('#city,#area').removeClass('kshow').addClass('khidden');

			        $('select[name=city]').empty(); //清除原有的元素
			        
			        var ob = $(this).val();
			        if(ob !=''){
			            $.ajax({
			                type: 'get',
			                url: '/index/address/city',
			                data: {id: ob},
			                success: function(response){
			                    console.log(response);
			                    $('select[name=city]').removeClass('khidden').addClass('kshow pro');
			                    var html = createHtml(JSON.parse(response));
			                    $('select[name=city]').append(html);
			                },
			                error: function(e){
			                    console.log(e);
			                }
			            });
			        }
			    });
			    //选择市
			    $('select[name=city]').click(function(){
			        $('select[name=area]').empty(); //清除原有的元素
			        
			            $.ajax({
			                type: 'get',
			                url: '/index/address/area',
			                data: {id: $(this).val()},
			                success: function(response){
			                    
			                    $('select[name=area]').removeClass('khidden').addClass('kshow pro');
			                    var html = createHtml(JSON.parse(response));
			                    $('select[name=area]').append(html);
			                },
			                error: function(e){
			                    console.log(e);
			                }
			            });
			        
			    });

			});
			function createHtml(data){
			    var html = '';
			    for(var i=0; i<data.length; i++){
			        html += '<option value="'+data[i]['id']+'">'+data[i]['name']+'</option>';
			    }
			    return html;
			}
			});
	</script>
	<{include file="public/footer"/}>
</body>
</html>